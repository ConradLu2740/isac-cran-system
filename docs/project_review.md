# ISAC-CRAN System 项目复盘

## 一、开发过程中遇到的问题与解决方案

### 1. 环境配置问题

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| Docker镜像源访问慢 | 默认镜像源在国外 | 配置国内镜像源 |
| npm install 卡住 | npm默认源在国外 | 使用淘宝镜像 `npm config set registry https://registry.npmmirror.com` |
| npm start 内存溢出 | Node.js默认内存限制 | 使用静态HTML替代React应用 |

### 2. 数据库问题

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| MySQL表不存在 | 数据库未初始化 | 手动创建表结构 |
| JSON字段插入失败 | MySQL JSON类型不接受空字符串 | 将字段改为可空类型 `*string` |
| 实验ID重复 | 测试时使用相同ID | 使用时间戳生成唯一ID |

### 3. Go语言问题

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| complex128无法JSON序列化 | Go的complex128类型没有默认JSON序列化 | 转换为 `[][]float64` 格式 |
| GORM自动迁移失败 | 表结构不匹配 | 手动创建表或修复模型定义 |
| 传感器列表为空 | Collector未从Simulator获取数据 | 添加GetAllSensorInfo方法 |

### 4. 前端问题

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| React内存溢出 | Node.js内存限制 | 创建静态HTML页面 |
| CORS跨域问题 | 前后端分离架构 | 后端添加CORS中间件 |
| 算法结果不显示 | 前端未处理返回数据 | 添加结果展示组件 |

---

## 二、Go开发知识点总结

### 1. 项目结构规范

```
isac-cran-system/
├── cmd/                    # 主程序入口
│   └── server/main.go
├── internal/               # 私有业务代码
│   ├── config/            # 配置管理
│   ├── handler/           # HTTP处理器
│   ├── service/           # 业务逻辑层
│   ├── repository/        # 数据访问层
│   ├── model/             # 数据模型
│   ├── middleware/        # 中间件
│   └── router/            # 路由配置
├── pkg/                    # 公共库
├── configs/               # 配置文件
├── scripts/               # 脚本文件
├── test/                  # 测试代码
└── docs/                  # 项目文档
```

### 2. 分层架构设计

```
请求 → Handler → Service → Repository → 数据库
         ↓
      Middleware (鉴权、日志、异常恢复)
```

**职责划分：**
- **Handler**: 参数校验、响应封装
- **Service**: 业务逻辑、事务管理
- **Repository**: 数据访问、CRUD操作
- **Model**: 数据结构定义

### 3. 常用库和框架

| 类别 | 库 | 用途 |
|------|------|------|
| Web框架 | Gin | HTTP服务和路由 |
| ORM | GORM | 数据库操作 |
| 配置管理 | Viper | 配置文件读取 |
| 日志 | Zap | 结构化日志 |
| 数据验证 | validator | 参数校验 |

### 4. 并发编程

```go
// 通道通信
ch := make(chan int, 10)

// 协程
go func() {
    ch <- data
}()

// 互斥锁
var mu sync.RWMutex
mu.Lock()
defer mu.Unlock()
```

### 5. 错误处理

```go
// 自定义错误码
var (
    ErrNotFound     = New(40001, "resource not found")
    ErrInvalidParam = New(40002, "invalid parameter")
)

// 错误包装
func Wrap(code int, message string, err error) error {
    return &Error{Code: code, Message: message, Cause: err}
}
```

---

## 三、通信课题知识点串联

### 1. 智能反射面（IRS）

**基本原理：**
- IRS由大量无源反射单元组成
- 通过调整每个单元的相移，可以改变反射信号的相位
- 可以实现信号增强、干扰抑制、覆盖扩展

**关键参数：**
- 阵元数量：影响波束分辨率
- 相移范围：通常0-2π
- 工作频率：本项目使用2.4GHz

### 2. 波束成形（Beamforming）

**数学模型：**
```
y = w^H * x
```
其中 w 为权向量，x 为接收信号向量。

**优化目标：**
- 最大化目标方向增益
- 最小化干扰方向增益
- 约束：||w|| = 1

**本项目实现：**
- 梯度下降优化
- 100次迭代
- 输出：波束方向图、主瓣方向、副瓣电平

### 3. DOA估计（MUSIC算法）

**基本原理：**
1. 计算接收信号协方差矩阵
2. 特征分解得到信号子空间和噪声子空间
3. 构建空间谱函数
4. 谱峰搜索得到DOA估计

**空间谱公式：**
```
P_MUSIC(θ) = 1 / (a^H(θ) * U_n * U_n^H * a(θ))
```

### 4. C-RAN架构

**特点：**
- 集中化处理：BBU集中部署
- 云化：虚拟化技术
- 协作化：多小区协作

**本项目实现：**
- 模拟IRS设备
- 模拟USRP采集
- 算法引擎处理

---

## 四、技术短板识别与补充建议

### 1. Go语言进阶

| 短板 | 建议 |
|------|------|
| 并发模式 | 学习Worker Pool、Pipeline模式 |
| 性能优化 | 学习pprof性能分析 |
| 测试覆盖 | 学习Mock、Stub测试技术 |
| 设计模式 | 学习Go常用设计模式 |

### 2. 通信算法

| 短板 | 建议 |
|------|------|
| 信号处理基础 | 学习数字信号处理 |
| 阵列信号处理 | 学习空间谱估计理论 |
| 优化理论 | 学习凸优化、梯度下降 |
| MATLAB验证 | 学习MATLAB信号处理工具箱 |

### 3. 系统设计

| 短板 | 建议 |
|------|------|
| 分布式系统 | 学习微服务架构 |
| 消息队列 | 学习Kafka、RabbitMQ |
| 容器编排 | 学习Kubernetes |
| 监控告警 | 学习Prometheus、Grafana |

---

## 五、项目亮点总结

### 1. 技术亮点

- **完整系统架构**：从需求到部署的完整开发流程
- **算法实现**：波束成形、DOA估计等核心算法
- **高性能**：QPS 2174，延迟1.35ms
- **工程化**：Docker容器化、CI/CD就绪

### 2. 可用于简历的项目描述

```
ISAC-CRAN System - 智能反射面辅助C-RAN通信感知一体化实验原型系统

技术栈：Go、Gin、GORM、MySQL、InfluxDB、Redis、Docker

主要工作：
1. 设计并实现分层架构的Web服务，包含18个RESTful API接口
2. 实现波束成形优化算法和DOA估计（MUSIC）算法
3. 开发IRS、USRP、传感器模拟器，支持设备状态监控和数据采集
4. 使用MySQL存储配置数据，InfluxDB存储时序数据
5. 实现完整的测试体系，单元测试覆盖率100%，QPS达2174

成果：
- 30+源文件，22个测试用例，3份项目文档
- 系统延迟1.35ms，支持100+并发请求
```

---

## 六、后续学习规划

### 短期（1-2周）

1. 深入学习Go并发编程
2. 补充信号处理基础知识
3. 完善项目文档

### 中期（1-2月）

1. 学习MATLAB信号处理工具箱
2. 实现更多通信算法（如OFDM、MIMO）
3. 学习微服务架构

### 长期（3-6月）

1. 深入研究IRS相关论文
2. 学习深度学习在通信中的应用
3. 准备研究生阶段研究计划

---

*文档生成时间：2026-02-22*
