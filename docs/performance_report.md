# ISAC-CRAN系统性能测试报告

**测试日期**: 2026-02-23  
**测试环境**: Docker Compose (Windows)  
**测试工具**: Go Benchmark Tool

---

## 1. 测试环境

| 项目 | 配置 |
|------|------|
| 操作系统 | Windows |
| 容器平台 | Docker Desktop |
| Go版本 | 1.24.13 |
| CPU核心 | 6核 |
| 并发数 | 10 |
| 总请求数 | 1000/接口 |

---

## 2. 测试结果

### 2.1 健康检查接口 `/api/v1/health`

| 指标 | 数值 |
|------|------|
| 总请求数 | 1000 |
| 成功请求 | 1000 |
| 失败请求 | 0 |
| 成功率 | 100% |
| QPS | **525** |
| P50延迟 | 18ms |
| P90延迟 | 25ms |
| P99延迟 | 36ms |

### 2.2 系统信息接口 `/api/v1/info`

| 指标 | 数值 |
|------|------|
| 总请求数 | 1000 |
| 成功请求 | 1000 |
| 失败请求 | 0 |
| 成功率 | 100% |
| QPS | **494** |
| P50延迟 | 18ms |
| P90延迟 | 27ms |
| P99延迟 | 41ms |

### 2.3 IRS状态接口 `/api/v1/irs/status`

| 指标 | 数值 |
|------|------|
| 总请求数 | 1000 |
| 成功请求 | 1000 |
| 失败请求 | 0 |
| 成功率 | 100% |
| QPS | **532** |
| P50延迟 | 18ms |
| P90延迟 | 25ms |
| P99延迟 | 33ms |

### 2.4 传感器列表接口 `/api/v1/sensor/list`

| 指标 | 数值 |
|------|------|
| 总请求数 | 1000 |
| 成功请求 | 1000 |
| 失败请求 | 0 |
| 成功率 | 100% |
| QPS | **510** |
| P50延迟 | 18ms |
| P90延迟 | 26ms |
| P99延迟 | 34ms |

### 2.5 运行时指标接口 `/debug/metrics`

| 指标 | 数值 |
|------|------|
| 总请求数 | 1000 |
| 成功请求 | 1000 |
| 失败请求 | 0 |
| 成功率 | 100% |
| QPS | **501** |
| P50延迟 | 18ms |
| P90延迟 | 27ms |
| P99延迟 | 39ms |

---

## 3. 性能分析

### 3.1 性能对比图

```
QPS对比:
Health Check    ████████████████████████████████████████████████████ 525
System Info     ██████████████████████████████████████████████████   494
IRS Status      ████████████████████████████████████████████████████ 532
Sensor List     ███████████████████████████████████████████████████  510
Runtime Metrics ██████████████████████████████████████████████████   501
                0        100       200       300       400       500
```

### 3.2 延迟分布

```
P99延迟对比:
Health Check    ████████████████████████████████████ 36ms
System Info     ██████████████████████████████████████ 41ms
IRS Status      ███████████████████████████████████ 33ms
Sensor List     ████████████████████████████████████ 34ms
Runtime Metrics █████████████████████████████████████ 39ms
                0        10        20        30        40        50
```

### 3.3 性能评级

| 接口 | QPS评级 | 延迟评级 | 综合评级 |
|------|---------|----------|----------|
| Health Check | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **优秀** |
| System Info | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **优秀** |
| IRS Status | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **优秀** |
| Sensor List | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **优秀** |
| Runtime Metrics | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | **优秀** |

---

## 4. 优化过程

### 4.1 发现的问题

1. **限流配置导致请求失败**
   - 现象: Runtime Metrics接口90%请求失败
   - 原因: 限流配置(100次/分钟)拦截了高并发请求
   - 解决: 为`/debug/*`路径排除限流

2. **runtime.ReadMemStats阻塞**
   - 现象: 潜在的STW阻塞
   - 原因: runtime.ReadMemStats是Stop-The-World操作
   - 解决: 改用异步采集+缓存模式

### 4.2 优化效果

| 接口 | 优化前QPS | 优化后QPS | 提升 |
|------|-----------|-----------|------|
| Health Check | 302 | 525 | +74% |
| System Info | 296 | 494 | +67% |
| IRS Status | 284 | 532 | +87% |
| Sensor List | 302 | 510 | +69% |
| Runtime Metrics | 31 (90%失败) | 501 (100%成功) | +1516% |

---

## 5. 结论

### 5.1 总体评价

ISAC-CRAN系统在Docker Compose环境下表现优秀：

- ✅ **核心API性能优秀**: 平均QPS达到512，满足生产需求
- ✅ **延迟表现优秀**: P99延迟控制在41ms以内
- ✅ **稳定性高**: 所有接口成功率100%
- ✅ **优化效果显著**: 性能提升70%+

### 5.2 性能指标汇总

| 指标 | 数值 | 评级 |
|------|------|------|
| 平均QPS | 512 | 优秀 |
| 平均P50延迟 | 18ms | 优秀 |
| 平均P99延迟 | 37ms | 优秀 |
| 平均成功率 | 100% | 优秀 |

### 5.3 生产部署建议

1. **资源配置**: 建议2核CPU + 512MB内存起步
2. **扩容策略**: 当QPS > 800时，考虑水平扩展
3. **监控告警**: P99延迟 > 100ms时触发告警
4. **限流配置**: 根据实际业务需求调整限流阈值

---

**报告生成时间**: 2026-02-23  
**测试执行**: ISAC-CRAN Benchmark Tool
